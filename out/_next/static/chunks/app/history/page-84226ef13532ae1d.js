(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{5801:function(e,t,a){Promise.resolve().then(a.bind(a,8257)),Promise.resolve().then(a.bind(a,3947))},8455:function(e,t,a){"use strict";function s(e){return t=>e.safeParse(t).success}a.d(t,{V:function(){return s}})},4383:function(e,t,a){"use strict";a.d(t,{X:function(){return s}});let s={PROFILE:"profile",STEPS:"steps",RUNNING:"running",OTHERS:"others",HISTORY:"history",SLEEP:"sleep"}},1708:function(e,t,a){"use strict";a.d(t,{FK:function(){return i},MP:function(){return o},s1:function(){return c}});var s=a(7307),n=a(1071),l=a(4383),r=a(4290);async function i(e){let t=await c(),a=[];return a=[...null!=t?t:[],e],await (0,s.S)("readwrite",s.U.DATA,e=>e.put(a,l.X.HISTORY)),"History data saved successfully!"}async function c(){let e=await (0,s.S)("readonly",s.U.DATA,e=>e.get(l.X.HISTORY));return e instanceof Array?await (0,r.Z)(null!=e?e:[],n.dH.ALL):null}async function o(e){return Array.isArray(e)&&0!==e.length?(await (0,s.S)("readwrite",s.U.DATA,t=>t.put(e,l.X.HISTORY)),"History data saved successfully!"):"Invalid history data!"}},5384:function(e,t,a){"use strict";a.d(t,{U:function(){return s}});let s={DATA:"data"}},4704:function(e,t,a){"use strict";a.d(t,{N:function(){return i},S:function(){return r}});var s=a(5384);let n=null;function l(){return new Promise((e,t)=>{if(n){e(n);return}let a=indexedDB.open("web-health-tracker",1);a.addEventListener("upgradeneeded",e=>{a.result.createObjectStore(s.U.DATA)}),a.addEventListener("success",()=>{n=a.result,e(a.result)}),a.addEventListener("error",t),a.addEventListener("blocked",t)})}function r(e,t,a){return new Promise((s,n)=>{l().then(l=>{let r=a(l.transaction(t,e).objectStore(t));r.addEventListener("success",()=>s(r.result)),r.addEventListener("error",()=>n(r.error))}).catch(n)})}function i(){return new Promise((e,t)=>{l().then(a=>{let n=a.transaction(s.U.DATA,"readwrite").objectStore(s.U.DATA).clear();n.addEventListener("success",()=>e()),n.addEventListener("error",()=>t(n.error))}).catch(t)})}},7307:function(e,t,a){"use strict";a.d(t,{S:function(){return s.S},U:function(){return n.U}});var s=a(4704),n=a(5384)},1071:function(e,t,a){"use strict";var s,n,l,r,i,c;a.d(t,{d1:function(){return l},dH:function(){return n},oX:function(){return s}}),(r=s||(s={})).Line="line",r.Bar="bar",(i=n||(n={}))[i.DAILY=30]="DAILY",i[i.WEEKLY=365]="WEEKLY",i[i.MONTHLY=365]="MONTHLY",i[i.ALL=0]="ALL",(c=l||(l={})).Daily="daily",c.Weekly="weekly",c.Monthly="monthly"},4290:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1071);async function n(e,t){return new Promise(a=>{if(t===s.dH.ALL){a(e?e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()):[]);return}let n=new Date;n.setDate(new Date().getDate()-t),a(e?e.slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).filter(e=>new Date(e.date)>=n):[])})}},8257:function(e,t,a){"use strict";a.d(t,{default:function(){return j}});var s=a(7437),n=a(2265),l=function(e){let{imageUrl:t,imageName:a,onClose:n}=e;return(0,s.jsxs)(s.Fragment,{children:[!t&&(0,s.jsx)("p",{children:"There is no image to show"}),t&&(0,s.jsx)("div",{className:"modal show d-block",tabIndex:-1,role:"dialog",children:(0,s.jsx)("div",{className:"modal-dialog modal-dialog-centered modal-xl",role:"document",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",children:a}),(0,s.jsx)("button",{type:"button",className:"btn-close",onClick:n,"aria-label":"Close"})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsx)("img",{src:t,alt:"history image",className:"w-100"})})]})})})]})},r=e=>{let{data:t}=e,[a,r]=(0,n.useState)(null),[i,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!1),u=e=>{r(e.url),c(e.name),d(!0)};return(0,n.useEffect)(()=>{o||(r(null),c(null))},[o]),(0,s.jsxs)("li",{className:"timeline-item mb-5 border rounded shadow-sm p-3",children:[(0,s.jsx)("h5",{className:"fw-bold",children:null==t?void 0:t.title}),(0,s.jsx)("p",{className:"text-muted mb-2 fw-bold",children:null==t?void 0:t.date}),(0,s.jsx)("p",{className:"text-muted",children:null==t?void 0:t.details}),(0,s.jsx)("div",{children:null==t?void 0:t.files.map((e,t)=>(0,s.jsx)("img",{src:e.url,alt:"Thumbnail ".concat(t),className:"thumbnail",onClick:()=>u(e),style:{cursor:"pointer",width:"100px",height:"auto",marginRight:"10px"}},t))}),o&&(0,s.jsx)(l,{imageUrl:a,imageName:i,onClose:()=>{d(!1)}})]})},i=a(1071),c=a(4290),o=function(e){let{data:t}=e,[a,l]=(0,n.useState)(null!=t?t:[]);return(0,n.useEffect)(()=>{(async()=>{l(await (0,c.Z)(null!=t?t:[],i.dH.ALL))})()},[t]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"py-5 p-3",children:(0,s.jsx)("ul",{className:"timeline",children:a.map((e,t)=>(0,s.jsx)(r,{data:e},t))})})})},d=a(1708),u=a(9772),m=a(8455);let h=u.z.object({title:u.z.string(),date:u.z.string(),details:u.z.string(),files:u.z.array(u.z.object({name:u.z.string(),url:u.z.string()})).optional()});async function f(e){let t=h.safeParse(e);if(!t.success)return{errors:t.error.flatten().fieldErrors,message:"Validation failed. Please check the form data."};let{date:a,title:s,details:n,files:l=[]}=t.data;try{let e=await (0,d.FK)({date:a,title:s,details:n,files:l});return{errors:{},message:e}}catch(e){return{errors:{},message:"Failed to save history data. Please try again later."}}}(0,m.V)(h);var x=function(e){let{onClose:t}=e,a=new Date().toISOString().split("T")[0],[l,r]=(0,n.useState)({date:a,title:"",details:"",files:[]}),i=e=>{let{id:t,value:a,type:s}=e.target;r(e=>({...e,[t]:"number"===s?Number(a):a}))},c=async e=>{let t=e.target.files;if(t){let e=Array.from(t).map(async e=>{let t=new FileReader;return new Promise((a,s)=>{t.onloadend=()=>{var s;let n=(null===(s=t.result)||void 0===s?void 0:s.toString())||"";a({name:e.name,url:n})},t.onerror=s,t.readAsDataURL(e)})}),a=await Promise.all(e);r(e=>({...e,files:a}))}},o=async e=>{e.preventDefault();let a=h.safeParse(l);if(!a.success){console.error(a.error);return}try{let e=await f(l);alert(e.message),t()}catch(e){console.error(e)}};return(0,s.jsx)("div",{className:"modal show d-block",tabIndex:-1,role:"dialog",children:(0,s.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",children:"Add history"}),(0,s.jsx)("button",{type:"button",className:"btn-close",onClick:t,"aria-label":"Close"})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsxs)("form",{onSubmit:o,children:[(0,s.jsxs)("div",{className:"m-3 d-flex",children:[(0,s.jsx)("label",{htmlFor:"date",className:"form-label col-3 h6",children:"Datetime:"}),(0,s.jsx)("input",{type:"date",className:"form-control",id:"date",value:l.date,onChange:i,required:!0})]}),(0,s.jsxs)("div",{className:"m-3 d-flex",children:[(0,s.jsx)("label",{htmlFor:"title",className:"form-label col-3 h6",children:"Title:"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"title",value:l.title,onChange:i,required:!0})]}),(0,s.jsxs)("div",{className:"m-3 d-flex",children:[(0,s.jsx)("label",{htmlFor:"details",className:"form-label col-3 h6",children:"Details:"}),(0,s.jsx)("textarea",{rows:5,cols:50,className:"form-control",id:"details",value:l.details,onChange:i,required:!0})]}),(0,s.jsxs)("div",{className:"m-3 d-flex",children:[(0,s.jsx)("label",{htmlFor:"files",className:"form-label col-3 h6",children:"Files:"}),(0,s.jsx)("input",{type:"file",id:"files",accept:".jpeg, .png, .jpg",multiple:!0,onChange:c})]}),(0,s.jsxs)("div",{className:"m-3 d-flex",children:[(0,s.jsx)("label",{className:"form-label col-3 h6"}),(0,s.jsx)("p",{className:"bg-body-secondary text-body-tertiary",children:"Only accept .jpeg, .png, .jpg files"})]}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:t,children:"Close"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-outline-primary",children:"Add history"})]})]})})]})})})},j=()=>{let[e,t]=(0,n.useState)(!1),[a,l]=(0,n.useState)(null),r=Array.isArray(a)&&a.length>0;return(0,n.useEffect)(()=>{(async function(){e||l(await (0,d.s1)())})()},[e]),(0,s.jsxs)(s.Fragment,{children:[r&&(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"py-5 p-3",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-end m-3",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>t(!0),children:"Add history"}),e&&(0,s.jsx)(x,{onClose:()=>t(!1)})]}),(0,s.jsx)(o,{data:a})]})}),!r&&(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"py-5 p-3",children:(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsx)("p",{className:"fs-5",children:"No medical history data found"}),(0,s.jsx)("hr",{}),(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>t(!0),children:"Add history"})}),e&&(0,s.jsx)(x,{onClose:()=>t(!1)})]})})})})]})}},3947:function(e,t,a){"use strict";var s=a(7437),n=a(2265),l=a(6463);t.default=()=>{(0,l.useRouter)();let e=(0,l.usePathname)(),[t,a]=(0,n.useState)(e);return(0,n.useEffect)(()=>{a(e)},[e]),(0,s.jsx)("nav",{id:"sidebarMenu",className:"col-md-3 col-lg-3 bg-light sidebar p-0",children:(0,s.jsx)("div",{className:"position-sticky",children:(0,s.jsxs)("ul",{className:"nav flex-column",children:[(0,s.jsx)("li",{className:"navbar-brand me-0 bg-dark d-flex justify-content-center bg-gradient",children:(0,s.jsx)("a",{className:"nav-link text-light","aria-current":"page",href:"/WebHealthTracker/",children:(0,s.jsx)("span",{className:"fs-5",children:"WebHealthTracker"})})}),(0,s.jsx)("hr",{className:"m-0"}),(0,s.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/workouts"===t?"bg-primary":""),children:(0,s.jsx)("a",{className:"nav-link ".concat("/workouts"===t?"text-light":""),href:"/WebHealthTracker/workouts",onClick:()=>a("/workouts"),children:"Workouts"})}),(0,s.jsx)("hr",{className:"m-0"}),(0,s.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/sleep"===t?"bg-primary":""),children:(0,s.jsx)("a",{className:"nav-link ".concat("/sleep"===t?"text-light":""),href:"/WebHealthTracker/sleep",onClick:()=>a("/sleep"),children:"Sleep data"})}),(0,s.jsx)("hr",{className:"m-0"}),(0,s.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/history"===t?"bg-primary":""),children:(0,s.jsx)("a",{className:"nav-link ".concat("/history"===t?"text-light":""),href:"/WebHealthTracker/history",onClick:()=>a("/history"),children:"Medical history"})}),(0,s.jsx)("hr",{className:"m-0"}),(0,s.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/management"===t?"bg-primary":""),children:(0,s.jsx)("a",{className:"nav-link ".concat("/management"===t?"text-light":""),href:"/WebHealthTracker/management",onClick:()=>a("/management"),children:"Management"})}),(0,s.jsx)("hr",{className:"m-0"})]})})})}}},function(e){e.O(0,[842,971,23,744],function(){return e(e.s=5801)}),_N_E=e.O()}]);