(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{5801:function(e,t,s){Promise.resolve().then(s.bind(s,8257)),Promise.resolve().then(s.bind(s,3947))},8455:function(e,t,s){"use strict";function a(e){return t=>e.safeParse(t).success}s.d(t,{V:function(){return a}})},4383:function(e,t,s){"use strict";s.d(t,{X:function(){return a}});let a={PROFILE:"profile",STEPS:"steps",RUNNING:"running",OTHERS:"others",HISTORY:"history",SLEEP:"sleep"}},1708:function(e,t,s){"use strict";s.d(t,{FK:function(){return i},MP:function(){return o},s1:function(){return c}});var a=s(7307),n=s(1071),l=s(4383),r=s(4290);async function i(e){let t=await c(),s=[];return s=[...null!=t?t:[],e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(s,l.X.HISTORY)),"History data saved successfully!"}async function c(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(l.X.HISTORY));return e instanceof Array?await (0,r.Z)(null!=e?e:[],n.dH.ALL):null}async function o(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,l.X.HISTORY)),"History data saved successfully!"):"Invalid history data!"}},5384:function(e,t,s){"use strict";s.d(t,{U:function(){return a}});let a={DATA:"data"}},4704:function(e,t,s){"use strict";s.d(t,{N:function(){return i},S:function(){return r}});var a=s(5384);let n=null;function l(){return new Promise((e,t)=>{if(n){e(n);return}let s=indexedDB.open("web-health-tracker",1);s.addEventListener("upgradeneeded",e=>{s.result.createObjectStore(a.U.DATA)}),s.addEventListener("success",()=>{n=s.result,e(s.result)}),s.addEventListener("error",t),s.addEventListener("blocked",t)})}function r(e,t,s){return new Promise((a,n)=>{l().then(l=>{let r=s(l.transaction(t,e).objectStore(t));r.addEventListener("success",()=>a(r.result)),r.addEventListener("error",()=>n(r.error))}).catch(n)})}function i(){return new Promise((e,t)=>{l().then(s=>{let n=s.transaction(a.U.DATA,"readwrite").objectStore(a.U.DATA).clear();n.addEventListener("success",()=>e()),n.addEventListener("error",()=>t(n.error))}).catch(t)})}},7307:function(e,t,s){"use strict";s.d(t,{S:function(){return a.S},U:function(){return n.U}});var a=s(4704),n=s(5384)},1071:function(e,t,s){"use strict";var a,n,l,r,i,c;s.d(t,{d1:function(){return l},dH:function(){return n},oX:function(){return a}}),(r=a||(a={})).Line="line",r.Bar="bar",(i=n||(n={}))[i.DAILY=30]="DAILY",i[i.WEEKLY=365]="WEEKLY",i[i.MONTHLY=365]="MONTHLY",i[i.ALL=0]="ALL",(c=l||(l={})).Daily="daily",c.Weekly="weekly",c.Monthly="monthly"},4290:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1071);async function n(e,t){return new Promise(s=>{if(t===a.dH.ALL){s(e?e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()):[]);return}let n=new Date;n.setDate(new Date().getDate()-t),s(e?e.slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).filter(e=>new Date(e.date)>=n):[])})}},8257:function(e,t,s){"use strict";s.d(t,{default:function(){return j}});var a=s(7437),n=s(2265),l=function(e){let{imageUrl:t,imageName:s,onClose:n}=e;return(0,a.jsxs)(a.Fragment,{children:[!t&&(0,a.jsx)("p",{children:"There is no image to show"}),t&&(0,a.jsx)("div",{className:"modal show d-block",tabIndex:-1,role:"dialog",children:(0,a.jsx)("div",{className:"modal-dialog modal-dialog-centered modal-xl",role:"document",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h5",{className:"modal-title",children:s}),(0,a.jsx)("button",{type:"button",className:"btn-close",onClick:n,"aria-label":"Close"})]}),(0,a.jsx)("div",{className:"modal-body",children:(0,a.jsx)("img",{src:t,alt:"history image",className:"w-100"})})]})})})]})},r=e=>{let{data:t}=e,[s,r]=(0,n.useState)(null),[i,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!1),u=e=>{r(e.url),c(e.name),d(!0)};return(0,n.useEffect)(()=>{o||(r(null),c(null))},[o]),(0,a.jsxs)("li",{className:"timeline-item mb-5 border rounded shadow-sm p-3",children:[(0,a.jsx)("h5",{className:"fw-bold",children:null==t?void 0:t.title}),(0,a.jsx)("p",{className:"text-muted mb-2 fw-bold",children:null==t?void 0:t.date}),(0,a.jsx)("p",{className:"text-muted",children:null==t?void 0:t.details}),(0,a.jsx)("div",{children:null==t?void 0:t.files.map((e,t)=>(0,a.jsx)("img",{src:e.url,alt:"Thumbnail ".concat(t),className:"thumbnail",onClick:()=>u(e),style:{cursor:"pointer",width:"100px",height:"auto",marginRight:"10px"}},t))}),o&&(0,a.jsx)(l,{imageUrl:s,imageName:i,onClose:()=>{d(!1)}})]})},i=s(1071),c=s(4290),o=function(e){let{data:t}=e,[s,l]=(0,n.useState)(null!=t?t:[]);return(0,n.useEffect)(()=>{(async()=>{l(await (0,c.Z)(null!=t?t:[],i.dH.ALL))})()},[t]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"py-5 p-3",children:(0,a.jsx)("ul",{className:"timeline",children:s.map((e,t)=>(0,a.jsx)(r,{data:e},t))})})})},d=s(1708),u=s(9772),m=s(8455);let h=u.z.object({title:u.z.string(),date:u.z.string(),details:u.z.string(),files:u.z.array(u.z.object({name:u.z.string(),url:u.z.string()})).optional()});async function f(e){let t=h.safeParse(e);if(!t.success)return{errors:t.error.flatten().fieldErrors,message:"Validation failed. Please check the form data."};let{date:s,title:a,details:n,files:l=[]}=t.data;try{let e=await (0,d.FK)({date:s,title:a,details:n,files:l});return{errors:{},message:e}}catch(e){return{errors:{},message:"Failed to save history data. Please try again later."}}}(0,m.V)(h);var x=function(e){let{onClose:t}=e,s=new Date().toISOString().split("T")[0],[l,r]=(0,n.useState)({date:s,title:"",details:"",files:[]}),i=e=>{let{id:t,value:s,type:a}=e.target;r(e=>({...e,[t]:"number"===a?Number(s):s}))},c=async e=>{let t=e.target.files;if(t){let e=Array.from(t).map(async e=>{let t=new FileReader;return new Promise((s,a)=>{t.onloadend=()=>{var a;let n=(null===(a=t.result)||void 0===a?void 0:a.toString())||"";s({name:e.name,url:n})},t.onerror=a,t.readAsDataURL(e)})}),s=await Promise.all(e);r(e=>({...e,files:s}))}},o=async e=>{e.preventDefault();let s=h.safeParse(l);if(!s.success){console.error(s.error);return}try{let e=await f(l);alert(e.message),t()}catch(e){console.error(e)}};return(0,a.jsx)("div",{className:"modal show d-block",tabIndex:-1,role:"dialog",children:(0,a.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h5",{className:"modal-title",children:"Add history"}),(0,a.jsx)("button",{type:"button",className:"btn-close",onClick:t,"aria-label":"Close"})]}),(0,a.jsx)("div",{className:"modal-body",children:(0,a.jsxs)("form",{onSubmit:o,children:[(0,a.jsxs)("div",{className:"m-3 d-flex",children:[(0,a.jsx)("label",{htmlFor:"date",className:"form-label col-3 h6",children:"Datetime:"}),(0,a.jsx)("input",{type:"date",className:"form-control",id:"date",value:l.date,onChange:i,required:!0})]}),(0,a.jsxs)("div",{className:"m-3 d-flex",children:[(0,a.jsx)("label",{htmlFor:"title",className:"form-label col-3 h6",children:"Title:"}),(0,a.jsx)("input",{type:"text",className:"form-control",id:"title",value:l.title,onChange:i,required:!0})]}),(0,a.jsxs)("div",{className:"m-3 d-flex",children:[(0,a.jsx)("label",{htmlFor:"details",className:"form-label col-3 h6",children:"Details:"}),(0,a.jsx)("textarea",{rows:5,cols:50,className:"form-control",id:"details",value:l.details,onChange:i,required:!0})]}),(0,a.jsxs)("div",{className:"m-3 d-flex",children:[(0,a.jsx)("label",{htmlFor:"files",className:"form-label col-3 h6",children:"Files:"}),(0,a.jsx)("input",{type:"file",id:"files",accept:".jpeg, .png, .jpg",multiple:!0,onChange:c})]}),(0,a.jsxs)("div",{className:"m-3 d-flex",children:[(0,a.jsx)("label",{className:"form-label col-3 h6"}),(0,a.jsx)("p",{className:"bg-body-secondary text-body-tertiary",children:"Only accept .jpeg, .png, .jpg files"})]}),(0,a.jsxs)("div",{className:"modal-footer",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:t,children:"Close"}),(0,a.jsx)("button",{type:"submit",className:"btn btn-outline-primary",children:"Add history"})]})]})})]})})})},j=()=>{let[e,t]=(0,n.useState)(!1),[s,l]=(0,n.useState)(null),r=Array.isArray(s)&&s.length>0;return(0,n.useEffect)(()=>{(async function(){e||l(await (0,d.s1)())})()},[e]),(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"py-5 p-3",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-end m-3",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>t(!0),children:"Add history"}),e&&(0,a.jsx)(x,{onClose:()=>t(!1)})]}),(0,a.jsx)(o,{data:s})]})}),!r&&(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"py-5 p-3",children:(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("p",{className:"fs-5",children:"No medical history data found"}),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>t(!0),children:"Add history"})}),e&&(0,a.jsx)(x,{onClose:()=>t(!1)})]})})})})]})}},3947:function(e,t,s){"use strict";var a=s(7437),n=s(2265),l=s(6463);t.default=()=>{(0,l.useRouter)();let e=(0,l.usePathname)(),[t,s]=(0,n.useState)(e);return(0,n.useEffect)(()=>{s(e)},[e]),(0,a.jsx)("nav",{id:"sidebarMenu",className:"col-md-3 col-lg-3 bg-light sidebar p-0",children:(0,a.jsx)("div",{className:"position-sticky",children:(0,a.jsxs)("ul",{className:"nav flex-column",children:[(0,a.jsx)("li",{className:"navbar-brand me-0 bg-dark d-flex justify-content-center bg-gradient",children:(0,a.jsx)("a",{className:"nav-link text-light","aria-current":"page",href:"/",children:(0,a.jsx)("span",{className:"fs-5",children:"WebHealthTracker"})})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/workouts"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/workouts"===t?"text-light":""),href:"/workouts",onClick:()=>s("/workouts"),children:"Workouts"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/sleep"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/sleep"===t?"text-light":""),href:"/sleep",onClick:()=>s("/sleep"),children:"Sleep data"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/history"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/history"===t?"text-light":""),href:"/history",onClick:()=>s("/history"),children:"Medical history"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/management"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/management"===t?"text-light":""),href:"/management",onClick:()=>s("/management"),children:"Management"})}),(0,a.jsx)("hr",{className:"m-0"})]})})})}}},function(e){e.O(0,[842,971,23,744],function(){return e(e.s=5801)}),_N_E=e.O()}]);