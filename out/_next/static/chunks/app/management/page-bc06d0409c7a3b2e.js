(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[393],{3079:function(e,t,n){Promise.resolve().then(n.bind(n,9131))},8455:function(e,t,n){"use strict";function a(e){return t=>e.safeParse(t).success}n.d(t,{V:function(){return a}})},4383:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});let a={PROFILE:"profile",STEPS:"steps",RUNNING:"running",OTHERS:"others",HISTORY:"history",SLEEP:"sleep"}},1708:function(e,t,n){"use strict";n.d(t,{FK:function(){return l},MP:function(){return o},s1:function(){return c}});var a=n(7307),r=n(1071),s=n(4383),i=n(4290);async function l(e){let t=await c(),n=[];return n=[...null!=t?t:[],e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(n,s.X.HISTORY)),"History data saved successfully!"}async function c(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(s.X.HISTORY));return e instanceof Array?await (0,i.Z)(null!=e?e:[],r.dH.ALL):null}async function o(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,s.X.HISTORY)),"History data saved successfully!"):"Invalid history data!"}},3032:function(e,t,n){"use strict";n.d(t,{TQ:function(){return l},xd:function(){return s},zN:function(){return i}});var a=n(7307),r=n(4383);async function s(e){let t=await i(),n=[];return n=t?[...t.filter(t=>t.date!==e.date),e]:[e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(n,r.X.OTHERS)),"Workout data saved successfully!"}async function i(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(r.X.OTHERS));return e instanceof Array?e:null}async function l(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,r.X.OTHERS)),"Workout data saved successfully!"):"Invalid workout data!"}},9028:function(e,t,n){"use strict";n.d(t,{A:function(){return i},q:function(){return s}});var a=n(7307),r=n(4383);async function s(e){return await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,r.X.PROFILE)),"Profile saved successfully!"}async function i(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(r.X.PROFILE));return e&&"string"==typeof e.firstName&&"string"==typeof e.lastName&&("male"===e.gender||"female"===e.gender||"prefer not to say"===e.gender)&&"number"==typeof e.age&&"number"==typeof e.height&&"number"==typeof e.weight?e:null}},2894:function(e,t,n){"use strict";n.d(t,{IN:function(){return s},NA:function(){return l},Xx:function(){return i}});var a=n(7307),r=n(4383);async function s(e){let t=await i(),n=[];return n=t?[...t.filter(t=>t.date!==e.date),e]:[e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(n,r.X.RUNNING)),"Running data saved successfully!"}async function i(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(r.X.RUNNING));return e instanceof Array?e:null}async function l(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,r.X.RUNNING)),"Running data saved successfully!"):"Invalid running data!"}},3351:function(e,t,n){"use strict";n.d(t,{WX:function(){return l},on:function(){return i},rw:function(){return s}});var a=n(7307),r=n(4383);async function s(e){let t=await i(),n=[];return n=t?[...t.filter(t=>t.date!==e.date),e]:[e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(n,r.X.SLEEP)),"Sleep data saved successfully!"}async function i(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(r.X.SLEEP));return e instanceof Array?e:null}async function l(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,r.X.SLEEP)),"Sleep data saved successfully!"):"Invalid sleep data!"}},3145:function(e,t,n){"use strict";n.d(t,{An:function(){return s},It:function(){return i},cF:function(){return l}});var a=n(7307),r=n(4383);async function s(e){let t=await i(),n=[];return n=t?[...t.filter(t=>t.date!==e.date),e]:[e],await (0,a.S)("readwrite",a.U.DATA,e=>e.put(n,r.X.STEPS)),"Steps saved successfully!"}async function i(){let e=await (0,a.S)("readonly",a.U.DATA,e=>e.get(r.X.STEPS));return e instanceof Array?e:null}async function l(e){return Array.isArray(e)&&0!==e.length?(await (0,a.S)("readwrite",a.U.DATA,t=>t.put(e,r.X.STEPS)),"Steps saved successfully!"):"Invalid steps data!"}},5384:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});let a={DATA:"data"}},4704:function(e,t,n){"use strict";n.d(t,{N:function(){return l},S:function(){return i}});var a=n(5384);let r=null;function s(){return new Promise((e,t)=>{if(r){e(r);return}let n=indexedDB.open("web-health-tracker",1);n.addEventListener("upgradeneeded",e=>{n.result.createObjectStore(a.U.DATA)}),n.addEventListener("success",()=>{r=n.result,e(n.result)}),n.addEventListener("error",t),n.addEventListener("blocked",t)})}function i(e,t,n){return new Promise((a,r)=>{s().then(s=>{let i=n(s.transaction(t,e).objectStore(t));i.addEventListener("success",()=>a(i.result)),i.addEventListener("error",()=>r(i.error))}).catch(r)})}function l(){return new Promise((e,t)=>{s().then(n=>{let r=n.transaction(a.U.DATA,"readwrite").objectStore(a.U.DATA).clear();r.addEventListener("success",()=>e()),r.addEventListener("error",()=>t(r.error))}).catch(t)})}},7307:function(e,t,n){"use strict";n.d(t,{S:function(){return a.S},U:function(){return r.U}});var a=n(4704),r=n(5384)},1071:function(e,t,n){"use strict";var a,r,s,i,l,c;n.d(t,{d1:function(){return s},dH:function(){return r},oX:function(){return a}}),(i=a||(a={})).Line="line",i.Bar="bar",(l=r||(r={}))[l.DAILY=30]="DAILY",l[l.WEEKLY=365]="WEEKLY",l[l.MONTHLY=365]="MONTHLY",l[l.ALL=0]="ALL",(c=s||(s={})).Daily="daily",c.Weekly="weekly",c.Monthly="monthly"},4290:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(1071);async function r(e,t){return new Promise(n=>{if(t===a.dH.ALL){n(e?e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()):[]);return}let r=new Date;r.setDate(new Date().getDate()-t),n(e?e.slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).filter(e=>new Date(e.date)>=r):[])})}},9131:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(7437),r=n(2265),s=n(3862),i=function(e){var t,n,r,s,i;let{profile:l}=e;return(0,a.jsxs)(a.Fragment,{children:[l&&(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,a.jsx)("div",{className:"fs-2",children:null!==(t="".concat(null==l?void 0:l.firstName,"  ").concat(null==l?void 0:l.lastName," "))&&void 0!==t?t:""}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"btn btn-sm",onClick:()=>window.location.href="/management/upsert",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",fill:"currentColor",className:"bi bi-pencil-square",viewBox:"0 0 16 16",children:[(0,a.jsx)("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),(0,a.jsx)("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})]})})})]}),(0,a.jsx)("hr",{}),(0,a.jsxs)("div",{className:"row align-items-center m-1",children:[(0,a.jsx)("span",{className:"col-3 fs-6",children:"Gender:"}),(0,a.jsx)("span",{className:"col-6 p-2 m-1",children:null!==(n=null==l?void 0:l.gender)&&void 0!==n?n:""})]}),(0,a.jsxs)("div",{className:"row align-items-center m-1",children:[(0,a.jsx)("span",{className:"col-3 fs-6",children:"Age:"}),(0,a.jsx)("span",{className:"col-6 p-2 m-1",children:null!==(r=null==l?void 0:l.age)&&void 0!==r?r:""})]}),(0,a.jsxs)("div",{className:"row align-items-center m-1",children:[(0,a.jsx)("span",{className:"col-3 fs-6",children:"Height:"}),(0,a.jsx)("span",{className:"col-6 p-2 m-1",children:"".concat((null==l?void 0:l.height)+" CM")})]}),(0,a.jsxs)("div",{className:"row align-items-center m-1",children:[(0,a.jsx)("span",{className:"col-3 fs-6",children:"Weight:"}),(0,a.jsx)("span",{className:"col-6 p-2 m-1",children:"".concat((null==l?void 0:l.weight)+" KG")})]})]}),!l&&(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("p",{className:"fs-5",children:"No profile found"}),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>window.location.href="/management/upsert",children:"Add profile"})})]})})]})},l=n(9028),c=n(2217),o=n(5990),u=n(1708),d=n(2894),f=n(3351),h=n(3145),m=n(3032);async function p(){let e=await (0,u.s1)(),t=await (0,d.Xx)(),n=await (0,f.on)(),a=await (0,h.It)(),r=await (0,l.A)(),s=await (0,m.zN)();return{history:null!=e?e:[],others:null!=s?s:[],running:null!=t?t:[],sleep:null!=n?n:[],steps:null!=a?a:[],profile:null!=r?r:{}}}async function w(){!function(e){let t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="web-health-tracker-".concat(function(){let e=new Date;return e.setHours(e.getHours()-3),function(e){if(isNaN(e.getFullYear()))throw Error("Invalid Date passed to formatDate");let t=String(e.getFullYear()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}(e)}()),a.click(),URL.revokeObjectURL(n)}(await p()),window.alert("Data exported successfully!")}var y=n(9772),v=n(8455);let x=y.z.object({history:y.z.unknown().optional(),others:y.z.unknown().optional(),running:y.z.unknown().optional(),sleep:y.z.unknown().optional(),steps:y.z.unknown().optional(),profile:y.z.unknown().optional()}),g=(0,v.V)(x);async function N(){var e;let t=await (e="application/json",new Promise((t,n)=>{let a=new AbortController,{signal:r}=a,s=document.createElement("input");s.type="file",e&&(s.accept=e),s.addEventListener("change",()=>{a.abort(),s.files?t(s.files[0]):t(null)},{once:!0,signal:r}),s.addEventListener("cancel",()=>{a.abort(),t(null)},{once:!0,signal:r}),s.showPicker()}));if(!t)return null;let n=JSON.parse(await new Promise((e,n)=>{let a=new FileReader;a.addEventListener("load",()=>{"string"==typeof a.result?e(a.result):n(Error("FileReader result was not a string"))}),a.addEventListener("error",()=>n(Error("FileReader encountered an error in reading the selected file"))),a.readAsText(t)}));if(!g(n))throw Error("Selected file's contents are not shaped like export data");return window.alert("Data imported successfully!"),window.location.reload(),n}async function j(e){await Promise.all([(0,u.MP)(e.history),(0,h.cF)(e.steps),(0,f.WX)(e.sleep),(0,d.NA)(e.running),(0,m.TQ)(e.others),(0,l.q)(e.profile)])}async function A(e){let t=await p();try{await j(e)}catch(n){try{await j(t)}catch(t){await Promise.all([(0,u.MP)(e.history),(0,h.cF)(e.steps),(0,f.WX)(e.sleep),(0,d.NA)(e.running),(0,m.TQ)(e.others),(0,l.q)(e.profile)])}throw n}}async function b(){let e=await (async()=>{try{return await N()}catch(e){console.error(e);return}})();if(e)try{await A(e)}catch(e){console.error(e)}}var S=n(4704),T=function(){let e=async e=>{e.preventDefault();try{await (0,S.N)(),window.alert("Data cleared successfully"),window.location.reload()}catch(e){window.alert("Failed to clear data"),console.error("Failed to clear data:",e)}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("div",{className:"d-flex justify-content-center fs-2",children:"Tool box"}),(0,a.jsx)("hr",{}),(0,a.jsxs)("div",{className:"pt-3 d-flex justify-content-around",children:[(0,a.jsx)("button",{className:"btn btn-outline-primary btn-lg",onClick:w,children:"Export data"}),(0,a.jsx)("button",{className:"btn btn-outline-primary btn-lg",onClick:b,children:"Import data"}),(0,a.jsx)("button",{className:"btn btn-outline-primary btn-lg",onClick:e,children:"Clear data"})]})]})})},k=()=>{let[e,t]=(0,r.useState)(null),[n,u]=(0,r.useState)(!0),[d,f]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,l.A)();t(e)}catch(e){f("Failed to fetch profile")}finally{u(!1)}})()},[]),(0,a.jsxs)(s.Z,{children:[n&&(0,a.jsx)(c.Z,{}),d&&(0,a.jsx)(o.Z,{error:d}),(0,a.jsx)("div",{className:"p-3",children:(0,a.jsx)("div",{className:"border rounded shadow-sm mt-5",children:(0,a.jsx)(i,{profile:e})})}),(0,a.jsx)("div",{className:"p-3 mt-4",children:(0,a.jsx)("div",{className:"border rounded shadow-sm",children:(0,a.jsx)(T,{})})})]})}},5990:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(7437);function r(e){let{error:t}=e;return(0,a.jsx)("div",{className:"loading-container",children:(0,a.jsx)("div",{className:"alert alert-danger",role:"alert",children:(0,a.jsx)("span",{className:"sr-only",children:t})})})}},2217:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(7437);function r(){return(0,a.jsx)("div",{className:"loading-container",children:(0,a.jsx)("div",{className:"spinner-border text-light",role:"status",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})})})}},3862:function(e,t,n){"use strict";var a=n(7437);n(2265);var r=n(3947);t.Z=e=>{let{children:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"d-flex",children:[(0,a.jsx)("div",{className:"col-md-3 ms-sm-auto col-lg-3 px-md-4",children:(0,a.jsx)(r.default,{})}),(0,a.jsx)("main",{className:"col-md-9 ms-sm-auto col-lg-9 px-md-4",children:t})]})})}},3947:function(e,t,n){"use strict";var a=n(7437),r=n(2265),s=n(6463);t.default=()=>{(0,s.useRouter)();let e=(0,s.usePathname)(),[t,n]=(0,r.useState)(e);return(0,r.useEffect)(()=>{n(e)},[e]),(0,a.jsx)("nav",{id:"sidebarMenu",className:"col-md-3 col-lg-3 bg-light sidebar p-0",children:(0,a.jsx)("div",{className:"position-sticky",children:(0,a.jsxs)("ul",{className:"nav flex-column",children:[(0,a.jsx)("li",{className:"navbar-brand me-0 bg-dark d-flex justify-content-center bg-gradient",children:(0,a.jsx)("a",{className:"nav-link text-light","aria-current":"page",href:"/",children:(0,a.jsx)("span",{className:"fs-5",children:"WebHealthTracker"})})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/WebHealthTracker/workouts"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/WebHealthTracker/workouts"===t?"text-light":""),href:"/workouts",onClick:()=>n("/workouts"),children:"Workouts"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/WebHealthTracker/sleep"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/WebHealthTracker/sleep"===t?"text-light":""),href:"/WebHealthTracker/sleep",onClick:()=>n("/WebHealthTracker/sleep"),children:"Sleep data"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/WebHealthTracker/history"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/WebHealthTracker/history"===t?"text-light":""),href:"/WebHealthTracker/history",onClick:()=>n("/WebHealthTracker/history"),children:"Medical history"})}),(0,a.jsx)("hr",{className:"m-0"}),(0,a.jsx)("li",{className:"p-3 m-0 nav-item fs-6 ".concat("/WebHealthTracker/management"===t?"bg-primary":""),children:(0,a.jsx)("a",{className:"nav-link ".concat("/WebHealthTracker/management"===t?"text-light":""),href:"/management",onClick:()=>n("/WebHealthTracker/management"),children:"Management"})}),(0,a.jsx)("hr",{className:"m-0"})]})})})}}},function(e){e.O(0,[842,971,23,744],function(){return e(e.s=3079)}),_N_E=e.O()}]);